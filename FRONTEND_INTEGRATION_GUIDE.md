# RealCulture AI Frontend Integration Guide

This document provides a comprehensive guide for frontend developers to correctly integrate with the RealCulture AI backend API endpoints. All endpoints require proper authentication unless otherwise specified.

## Base URL

```
https://realculture-backend-g3b9deb2fja4b8a2.canadacentral-01.azurewebsites.net
```

## Authentication Endpoints

### 1. User Registration
- **Endpoint**: `POST /auth/register`
- **Description**: Register a new user
- **Request Body**:
  ```json
  {
    "email": "string",
    "password": "string",
    "name": "string"
  }
  ```
- **Response**:
  ```json
  {
    "access_token": "string",
    "refresh_token": "string",
    "user": {
      "userId": "string",
      "email": "string",
      "name": "string",
      "role": "string",
      "credits": "number"
    }
  }
  ```

### 2. User Login
- **Endpoint**: `POST /auth/login`
- **Description**: Authenticate user and get tokens
- **Request Body**:
  ```json
  {
    "email": "string",
    "password": "string"
  }
  ```
- **Response**:
  ```json
  {
    "access_token": "string",
    "refresh_token": "string",
    "user": {
      "userId": "string",
      "email": "string",
      "name": "string",
      "role": "string",
      "credits": "number"
    }
  }
  ```

### 3. Google Login
- **Endpoint**: `POST /auth/google-login`
- **Description**: Authenticate user with Google
- **Request Body**:
  ```json
  {
    "token": "string" // Google OAuth token
  }
  ```
- **Response**:
  ```json
  {
    "access_token": "string",
    "refresh_token": "string",
    "user": {
      "userId": "string",
      "email": "string",
      "name": "string",
      "role": "string",
      "credits": "number"
    }
  }
  ```

### 4. Refresh Token
- **Endpoint**: `POST /auth/refresh`
- **Description**: Refresh access token using refresh token
- **Headers**: 
  - `Authorization: Bearer {refresh_token}`
- **Response**:
  ```json
  {
    "access_token": "string",
    "refresh_token": "string"
  }
  ```

### 5. Logout
- **Endpoint**: `POST /auth/logout`
- **Description**: Logout user (invalidate tokens)
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  {
    "statusCode": 200,
    "message": "Logout successful"
  }
  ```

### 6. Get User Profile
- **Endpoint**: `GET /auth/me`
- **Description**: Get authenticated user's profile
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  {
    "userId": "string",
    "email": "string",
    "name": "string",
    "role": "string",
    "plan": "string",
    "credits": "number",
    "picture": "string"
  }
  ```

## User Endpoints

### 1. Get User Credits
- **Endpoint**: `GET /user/credits`
- **Description**: Get current user's credits
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  {
    "credits": "number"
  }
  ```

### 2. Get User Profile
- **Endpoint**: `GET /user/me`
- **Description**: Get authenticated user's profile
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  {
    "userId": "string",
    "email": "string",
    "name": "string",
    "role": "string",
    "plan": "string",
    "credits": "number"
  }
  ```

### 3. Get User Images
- **Endpoint**: `GET /user/images`
- **Description**: Get images generated by the user
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Query Parameters**:
  - `page`: number (optional, default: 1)
  - `limit`: number (optional, default: 10)
- **Response**:
  ```json
  {
    "data": [
      {
        "id": "string",
        "prompt": "string",
        "imageUrl": "string",
        "filename": "string",
        "plan": "string",
        "createdAt": "date"
      }
    ],
    "meta": {
      "page": "number",
      "limit": "number",
      "total": "number"
    }
  }
  ```

### 4. Set User Credits (Admin)
- **Endpoint**: `PATCH /user/admin/set-credits`
- **Description**: Set user credits (admin only)
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "credits": "number"
  }
  ```
- **Response**:
  ```json
  {
    "success": true,
    "message": "✅ Créditos actualizados a {credits}"
  }
  ```

### 5. Decrement User Credits
- **Endpoint**: `PATCH /user/decrement-credits`
- **Description**: Decrement user credits
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "amount": "number"
  }
  ```
- **Response**:
  ```json
  {
    "message": "Se descontaron {amount} créditos correctamente.",
    "credits": "number"
  }
  ```

### 6. Upgrade User Plan
- **Endpoint**: `PATCH /user/upgrade`
- **Description**: Upgrade user plan
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "newPlan": "CREATOR" | "PRO"
  }
  ```
- **Response**:
  ```json
  {
    "message": "✅ Plan actualizado exitosamente",
    "plan": "string",
    "credits": "number"
  }
  ```

## Media Generation Endpoints

### 1. Generate Media Content
- **Endpoint**: `POST /media/{type}`
- **Description**: Generate different types of media content
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Path Parameters**:
  - `type`: "image" | "video" | "voice" | "music" | "agent"
- **Request Body**:
  ```json
  {
    "prompt": "string"
  }
  ```
- **Response**:
  ```json
  {
    "success": true,
    "message": "✅ {TYPE} generado correctamente",
    "result": {},
    "credits": "number"
  }
  ```

### 2. Get Generated Images
- **Endpoint**: `GET /media/images`
- **Description**: Get generated images
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Query Parameters**:
  - `page`: number (optional, default: 1)
  - `limit`: number (optional, default: 10)
- **Response**:
  ```json
  {
    "success": true,
    "result": {
      "data": [],
      "meta": {
        "page": "number",
        "limit": "number",
        "total": "number"
      }
    }
  }
  ```

### 3. Proxy Image
- **Endpoint**: `GET /media/proxy-image`
- **Description**: Proxy an image from a URL (public endpoint)
- **Query Parameters**:
  - `url`: string (URL of the image to proxy)
- **Response**: Image file

### 4. Serve Audio Preview
- **Endpoint**: `GET /media/preview/{filename}`
- **Description**: Serve audio file preview
- **Path Parameters**:
  - `filename`: string (name of the audio file)
- **Response**: Audio file

### 5. Get Signed Image URL
- **Endpoint**: `GET /media/signed-image/{filename}`
- **Description**: Get signed URL for an image
- **Path Parameters**:
  - `filename`: string (name of the image file)
- **Response**:
  ```json
  {
    "url": "string"
  }
  ```

### 6. Get My Images
- **Endpoint**: `GET /media/my-images`
- **Description**: Get authenticated user's images
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Query Parameters**:
  - `page`: number (optional, default: 1)
  - `limit`: number (optional, default: 10)
- **Response**:
  ```json
  {
    "data": [],
    "meta": {
      "page": "number",
      "limit": "number",
      "total": "number"
    }
  }
  ```

## Audio Generation Endpoints

### 1. Generate Audio
- **Endpoint**: `POST /audio/generate`
- **Description**: Generate audio from prompt with optional promotional style
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "prompt": "string",
    "duration": 20 | 30 | 60,
    "style": "promotional" | "narrative" | "casual" (optional, defaults to "promotional")
  }
  ```
- **Response**:
  ```json
  {
    "message": "Audio promocional generado con éxito",
    "script": "string",
    "audioUrl": "string",
    "duration": "number",
    "creditsUsed": "number",
    "style": "string"
  }
  ```

### 2. Register Generated Audio
- **Endpoint**: `POST /audio/complete`
- **Description**: Register generated audio
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "userId": "string",
    "prompt": "string",
    "audioUrl": "string",
    "duration": "number"
  }
  ```
- **Response**:
  ```json
  {
    "status": "success",
    "message": "Audio registrado exitosamente"
  }
  ```

## Video Generation Endpoints

### 1. Generate Video
- **Endpoint**: `POST /video/generate`
- **Description**: Generate video from prompt
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "prompt": "string",
    "n_seconds": "number"
  }
  ```
- **Response**:
  ```json
  {
    "success": true,
    "result": {
      "videoUrl": "string",
      "audioUrl": "string",
      "subtitlesUrl": "string",
      "script": "string",
      "prompt": "string"
    },
    "credits": "number"
  }
  ```

## Promo Image Generation Endpoints

### 1. Generate Promotional Image
- **Endpoint**: `POST /promo-image`
- **Description**: Generate promotional image from prompt
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "prompt": "string"
  }
  ```
- **Response**:
  ```json
  {
    "success": true,
    "result": {
      "signedUrl": "string",
      "imageUrl": "string",
      "fileName": "string"
    },
    "credits": "number"
  }
  ```

## Prompt JSON Generation Endpoints

### 1. Generate JSON from Prompt
- **Endpoint**: `POST /prompt-json`
- **Description**: Generate JSON from prompt
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "prompt": "string"
  }
  ```
- **Response**:
  ```json
  {
    "success": true,
    "message": "✅ JSON generado correctamente",
    "result": {},
    "credits": "number"
  }
  ```

## Gallery Endpoints

### 1. Get User Gallery
- **Endpoint**: `GET /gallery`
- **Description**: Get user's gallery (Creator/PRO only)
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  [
    {
      "id": "string",
      "type": "string",
      "prompt": "string",
      "mediaUrl": "string",
      "status": "string",
      "createdAt": "date",
      "filename": "string",
      "duration": "number",
      "title": "string",
      "description": "string",
      "signedUrl": "string"
    }
  ]
  ```

## Credits Endpoints

### 1. Buy Credits
- **Endpoint**: `POST /credits/buy`
- **Description**: Buy credits
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "amount": "number"
  }
  ```
- **Response**:
  ```json
  {
    "success": true,
    "message": "✅ Créditos comprados exitosamente",
    "credits": "number"
  }
  ```

### 2. Get Available Credits
- **Endpoint**: `GET /credits/available`
- **Description**: Get available credits for purchase
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  {
    "credits": [
      {
        "amount": "number",
        "price": "number"
      }
    ]
  }
  ```

## Content Management Endpoints

### 1. Create Content
- **Endpoint**: `POST /content`
- **Description**: Create new content
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "type": "string",
    "prompt": "string",
    "mediaUrl": "string",
    "status": "string"
  }
  ```
- **Response**:
  ```json
  {
    "id": "string",
    "type": "string",
    "prompt": "string",
    "mediaUrl": "string",
    "status": "string",
    "createdAt": "date"
  }
  ```

### 2. Get All Content
- **Endpoint**: `GET /content`
- **Description**: Get all content
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  [
    {
      "id": "string",
      "type": "string",
      "prompt": "string",
      "mediaUrl": "string",
      "status": "string",
      "createdAt": "date"
    }
  ]
  ```

### 3. Get Content by ID
- **Endpoint**: `GET /content/{id}`
- **Description**: Get content by ID
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Path Parameters**:
  - `id`: string
- **Response**:
  ```json
  {
    "id": "string",
    "type": "string",
    "prompt": "string",
    "mediaUrl": "string",
    "status": "string",
    "createdAt": "date"
  }
  ```

### 4. Update Content
- **Endpoint**: `PUT /content/{id}`
- **Description**: Update content by ID
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Path Parameters**:
  - `id`: string
- **Request Body**:
  ```json
  {
    "type": "string",
    "prompt": "string",
    "mediaUrl": "string",
    "status": "string"
  }
  ```
- **Response**:
  ```json
  {
    "id": "string",
    "type": "string",
    "prompt": "string",
    "mediaUrl": "string",
    "status": "string",
    "createdAt": "date"
  }
  ```

### 5. Delete Content
- **Endpoint**: `DELETE /content/{id}`
- **Description**: Delete content by ID
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Path Parameters**:
  - `id`: string
- **Response**:
  ```json
  {
    "message": "Content deleted successfully"
  }
  ```

## Creator Endpoints

### 1. Create Creator
- **Endpoint**: `POST /creator`
- **Description**: Create new creator
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "name": "string",
    "bio": "string"
  }
  ```
- **Response**:
  ```json
  {
    "id": "string",
    "name": "string",
    "bio": "string",
    "createdAt": "date"
  }
  ```

### 2. Get All Creators
- **Endpoint**: `GET /creator`
- **Description**: Get all creators
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  [
    {
      "id": "string",
      "name": "string",
      "bio": "string",
      "createdAt": "date"
    }
  ]
  ```

## Influencer Endpoints

### 1. Create Influencer
- **Endpoint**: `POST /influencer`
- **Description**: Create new influencer
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Request Body**:
  ```json
  {
    "name": "string",
    "platform": "string"
  }
  ```
- **Response**:
  ```json
  {
    "id": "string",
    "name": "string",
    "platform": "string",
    "createdAt": "date"
  }
  ```

### 2. Get All Influencers
- **Endpoint**: `GET /influencer`
- **Description**: Get all influencers
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  [
    {
      "id": "string",
      "name": "string",
      "platform": "string",
      "createdAt": "date"
    }
  ]
  ```

### 3. Get Influencer by ID
- **Endpoint**: `GET /influencer/{id}`
- **Description**: Get influencer by ID
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Path Parameters**:
  - `id`: string
- **Response**:
  ```json
  {
    "id": "string",
    "name": "string",
    "platform": "string",
    "createdAt": "date"
  }
  ```

## Health Check Endpoints

### 1. Ping
- **Endpoint**: `GET /health/ping`
- **Description**: Health check endpoint
- **Response**:
  ```json
  {
    "message": "pong"
  }
  ```

### 2. Database Health
- **Endpoint**: `GET /health/db`
- **Description**: Database health check
- **Response**:
  ```json
  {
    "status": "ok",
    "timestamp": "date"
  }
  ```

## Data Cleanup Endpoints

### 1. Delete Old Content
- **Endpoint**: `DELETE /data-cleanup/old-content`
- **Description**: Delete old content (admin only)
- **Headers**: 
  - `Authorization: Bearer {access_token}`
- **Response**:
  ```json
  {
    "message": "Old content deleted successfully",
    "deletedCount": "number"
  }
  ```

## Error Responses

All endpoints may return the following error responses:

- **400 Bad Request**: Invalid request data
- **401 Unauthorized**: Missing or invalid authentication
- **403 Forbidden**: Insufficient permissions
- **404 Not Found**: Resource not found
- **500 Internal Server Error**: Server error

Error response format:
```json
{
  "statusCode": "number",
  "message": "string",
  "error": "string"
}
```

## Authentication Headers

For all protected endpoints, include the following header:
```
Authorization: Bearer {access_token}
```

## Rate Limiting

The API implements rate limiting to prevent abuse. If you exceed the rate limit, you will receive a 429 Too Many Requests response.

## Best Practices

1. Always handle authentication errors and refresh tokens when needed
2. Implement proper error handling for all API calls
3. Cache responses when appropriate to reduce API calls
4. Use pagination for endpoints that return lists of data
5. Validate request data before sending to the API
6. Handle network errors gracefully
7. Display loading states during API calls
8. Show appropriate error messages to users